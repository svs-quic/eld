<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SFrame Support &mdash; ELD  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/index.css" type="text/css" />
      <link rel="stylesheet" href="/home/runner/work/eld/eld/obj/tools/eld/docs/userguide/source/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            ELD
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="linker_overview.html">1. Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="linking_modes_supported.html">2. Supported Linking Modes</a></li>
<li class="toctree-l1"><a class="reference internal" href="supported_targets.html">3. Supported Targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="linker_script.html">4. Linker Script</a></li>
<li class="toctree-l1"><a class="reference internal" href="linker_diagnostics.html">5. Diagnostics</a></li>
<li class="toctree-l1"><a class="reference internal" href="linker_support_backward_compatibility.html">6. Shared Library Versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="linker_support_backward_compatibility.html#gnu-elf-symbol-versioning">7. GNU ELF Symbol Versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_structure_and_generation.html">8. Image Structure and Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="linker_map_files.html">9. Linker Map Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="layout.html">10. Image layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="linker_plugins_updated.html">11. Linker Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="linker_optimizations.html">12. Linker Optimization Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="lto_support.html">13. LTO Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_image_details.html">14. Getting Image Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="options/options.html">15. Command-line options</a></li>
<li class="toctree-l1"><a class="reference internal" href="target_specific_features.html">16. Target Specific Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="linker_faq.html">17. Linker support and frequently asked questions!!!</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ELD</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">SFrame Support</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="sframe-support">
<h1>SFrame Support<a class="headerlink" href="#sframe-support" title="Permalink to this heading"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id1">Overview</a></p></li>
<li><p><a class="reference internal" href="#sframe-vs-ehframe" id="id2">SFrame vs EhFrame</a></p></li>
<li><p><a class="reference internal" href="#command-line-options" id="id3">Command Line Options</a></p></li>
<li><p><a class="reference internal" href="#usage-examples" id="id4">Usage Examples</a></p>
<ul>
<li><p><a class="reference internal" href="#basic-linking-with-sframe" id="id5">Basic Linking with SFrame</a></p></li>
<li><p><a class="reference internal" href="#shared-library-with-sframe" id="id6">Shared Library with SFrame</a></p></li>
<li><p><a class="reference internal" href="#combining-with-other-options" id="id7">Combining with Other Options</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#section-processing" id="id8">Section Processing</a></p>
<ul>
<li><p><a class="reference internal" href="#input-processing" id="id9">Input Processing</a></p></li>
<li><p><a class="reference internal" href="#output-generation" id="id10">Output Generation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#supported-architectures" id="id11">Supported Architectures</a></p></li>
<li><p><a class="reference internal" href="#integration-with-debugging-tools" id="id12">Integration with Debugging Tools</a></p></li>
<li><p><a class="reference internal" href="#garbage-collection-behavior" id="id13">Garbage Collection Behavior</a></p></li>
<li><p><a class="reference internal" href="#error-handling" id="id14">Error Handling</a></p></li>
<li><p><a class="reference internal" href="#performance-considerations" id="id15">Performance Considerations</a></p></li>
<li><p><a class="reference internal" href="#best-practices" id="id16">Best Practices</a></p></li>
<li><p><a class="reference internal" href="#troubleshooting" id="id17">Troubleshooting</a></p></li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id1">Overview</a><a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>SFrame (Simple Frame) is a lightweight debugging format that provides stack unwinding information for debuggers and profilers. ELD provides comprehensive support for processing <cite>.sframe</cite> sections and creating SFrame headers in linked executables and shared libraries.</p>
<p>The SFrame format is designed to be much simpler and more compact than DWARF debug information, focusing solely on the minimal information needed for stack unwinding:</p>
<ul class="simple">
<li><p><strong>Canonical Frame Address (CFA)</strong>: The address of the call frame</p></li>
<li><p><strong>Frame Pointer (FP)</strong>: Location of the frame pointer</p></li>
<li><p><strong>Return Address (RA)</strong>: Location of the return address</p></li>
</ul>
<p>ELD implements support for <strong>SFrame version 2 (errata 1)</strong> as specified in the SFrame Format documentation.</p>
</div>
<div class="section" id="sframe-vs-ehframe">
<h2><a class="toc-backref" href="#id2">SFrame vs EhFrame</a><a class="headerlink" href="#sframe-vs-ehframe" title="Permalink to this heading"></a></h2>
<p>SFrame offers several advantages over the traditional EhFrame format:</p>
<dl class="simple">
<dt><strong>Size Efficiency</strong></dt><dd><p>SFrame sections are significantly smaller than equivalent EhFrame sections, resulting in reduced binary size and memory usage.</p>
</dd>
<dt><strong>Parsing Speed</strong></dt><dd><p>The simplified format allows for faster parsing during stack unwinding operations.</p>
</dd>
<dt><strong>Reduced Complexity</strong></dt><dd><p>SFrame eliminates much of the complexity of DWARF-based unwinding while maintaining the essential functionality.</p>
</dd>
<dt><strong>Better Cache Performance</strong></dt><dd><p>The compact format leads to better cache utilization during runtime stack unwinding.</p>
</dd>
</dl>
</div>
<div class="section" id="command-line-options">
<h2><a class="toc-backref" href="#id3">Command Line Options</a><a class="headerlink" href="#command-line-options" title="Permalink to this heading"></a></h2>
<p>ELD provides the following command line option for SFrame support:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">--sframe-hdr</span></code></dt><dd><p>Create an SFrame header section and process <cite>.sframe</cite> sections in input files. This option enables:</p>
<ul class="simple">
<li><p>Processing of <cite>.sframe</cite> sections from input object files</p></li>
<li><p>Creation of consolidated SFrame sections in the output</p></li>
<li><p>Proper linking and address resolution for SFrame data</p></li>
<li><p>Integration with ELD’s section layout and memory management</p></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="usage-examples">
<h2><a class="toc-backref" href="#id4">Usage Examples</a><a class="headerlink" href="#usage-examples" title="Permalink to this heading"></a></h2>
<div class="section" id="basic-linking-with-sframe">
<h3><a class="toc-backref" href="#id5">Basic Linking with SFrame</a><a class="headerlink" href="#basic-linking-with-sframe" title="Permalink to this heading"></a></h3>
<p>To link object files containing <cite>.sframe</cite> sections and create an SFrame header:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create source file with SFrame section</span>
cat<span class="w"> </span>&gt;<span class="w"> </span>source1.s<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
<span class="s">.text</span>
<span class="s">.globl func1</span>
<span class="s">func1:</span>
<span class="s">    ret</span>
<span class="s">.section .sframe,&quot;a&quot;              # Type automatically set to SHT_GNU_SFRAME (llvm-mc 22.x+)</span>
<span class="s">.byte 0xe2, 0xde, 0x02, 0x08      # SFrame header with magic and version</span>
<span class="s">EOF</span>

<span class="c1"># Assemble files containing SFrame sections (requires llvm-mc 22.x or newer)</span>
llvm-mc<span class="w"> </span>-filetype<span class="o">=</span>obj<span class="w"> </span>-triple<span class="o">=</span>x86_64-linux-gnu<span class="w"> </span>source1.s<span class="w"> </span>-o<span class="w"> </span>source1.o
llvm-mc<span class="w"> </span>-filetype<span class="o">=</span>obj<span class="w"> </span>-triple<span class="o">=</span>x86_64-linux-gnu<span class="w"> </span>source2.s<span class="w"> </span>-o<span class="w"> </span>source2.o

<span class="c1"># Link with SFrame header creation</span>
eld<span class="w"> </span>--sframe-hdr<span class="w"> </span>source1.o<span class="w"> </span>source2.o<span class="w"> </span>-o<span class="w"> </span>executable
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For llvm-mc versions prior to 22.x, the section type must be specified explicitly:</p>
<div class="highlight-assembly notranslate"><div class="highlight"><pre><span></span>.section .sframe,&quot;a&quot;,@0x6ffffff4  # Explicit SHT_GNU_SFRAME type for older assemblers
</pre></div>
</div>
</div>
</div>
<div class="section" id="shared-library-with-sframe">
<h3><a class="toc-backref" href="#id6">Shared Library with SFrame</a><a class="headerlink" href="#shared-library-with-sframe" title="Permalink to this heading"></a></h3>
<p>SFrame sections can also be included in shared libraries:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create shared library with SFrame information</span>
eld<span class="w"> </span>--sframe-hdr<span class="w"> </span>-shared<span class="w"> </span>libfoo.o<span class="w"> </span>-o<span class="w"> </span>libfoo.so
</pre></div>
</div>
</div>
<div class="section" id="combining-with-other-options">
<h3><a class="toc-backref" href="#id7">Combining with Other Options</a><a class="headerlink" href="#combining-with-other-options" title="Permalink to this heading"></a></h3>
<p>SFrame support works seamlessly with other ELD features:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># SFrame with garbage collection</span>
eld<span class="w"> </span>--sframe-hdr<span class="w"> </span>--gc-sections<span class="w"> </span>input.o<span class="w"> </span>-o<span class="w"> </span>output

<span class="c1"># SFrame with optimization</span>
eld<span class="w"> </span>--sframe-hdr<span class="w"> </span>-O2<span class="w"> </span>input.o<span class="w"> </span>-o<span class="w"> </span>output

<span class="c1"># SFrame with debug symbols</span>
eld<span class="w"> </span>--sframe-hdr<span class="w"> </span>--debug<span class="w"> </span>input.o<span class="w"> </span>-o<span class="w"> </span>output
</pre></div>
</div>
</div>
</div>
<div class="section" id="section-processing">
<h2><a class="toc-backref" href="#id8">Section Processing</a><a class="headerlink" href="#section-processing" title="Permalink to this heading"></a></h2>
<div class="section" id="input-processing">
<h3><a class="toc-backref" href="#id9">Input Processing</a><a class="headerlink" href="#input-processing" title="Permalink to this heading"></a></h3>
<p>ELD processes <cite>.sframe</cite> sections from input object files by:</p>
<ol class="arabic simple">
<li><p><strong>Recognition</strong>: Identifying <cite>.sframe</cite> sections in ELF input files</p></li>
<li><p><strong>Parsing</strong>: Validating SFrame headers and parsing FRE (Frame Row Entry) data</p></li>
<li><p><strong>Merging</strong>: Combining multiple <cite>.sframe</cite> sections from different input files</p></li>
<li><p><strong>Address Resolution</strong>: Resolving function addresses and updating SFrame data</p></li>
</ol>
</div>
<div class="section" id="output-generation">
<h3><a class="toc-backref" href="#id10">Output Generation</a><a class="headerlink" href="#output-generation" title="Permalink to this heading"></a></h3>
<p>When the <cite>–sframe-hdr</cite> option is specified, ELD creates:</p>
<ul class="simple">
<li><p><strong>Consolidated .sframe section</strong>: Contains all SFrame data from input files</p></li>
<li><p><strong>Proper section alignment</strong>: Ensures correct alignment for runtime access</p></li>
<li><p><strong>Address fixups</strong>: Updates all address references to final linked addresses</p></li>
<li><p><strong>Section headers</strong>: Creates appropriate ELF section headers for SFrame data</p></li>
</ul>
</div>
</div>
<div class="section" id="supported-architectures">
<h2><a class="toc-backref" href="#id11">Supported Architectures</a><a class="headerlink" href="#supported-architectures" title="Permalink to this heading"></a></h2>
<p>ELD’s SFrame support is available for the architectures with ABI identifiers
defined in the <a class="reference external" href="https://sourceware.org/binutils/docs/sframe-spec.html">SFrame specification</a>:</p>
<ul class="simple">
<li><p><strong>AArch64</strong>: ARM 64-bit architecture (little-endian and big-endian)</p></li>
<li><p><strong>AMD64 (x86_64)</strong>: AMD/Intel 64-bit architecture (little-endian)</p></li>
</ul>
<p>Other architectures are not yet assigned ABI identifiers in the SFrame
specification and are not currently supported.</p>
</div>
<div class="section" id="integration-with-debugging-tools">
<h2><a class="toc-backref" href="#id12">Integration with Debugging Tools</a><a class="headerlink" href="#integration-with-debugging-tools" title="Permalink to this heading"></a></h2>
<p>SFrame sections created by ELD are compatible with tools that support the
SFrame format:</p>
<ul class="simple">
<li><p><strong>GDB</strong>: GNU Debugger (version 16+) can use SFrame information for stack unwinding</p></li>
<li><p><strong>libsframe</strong>: The libsframe library (from GNU binutils) can parse SFrame sections</p></li>
</ul>
</div>
<div class="section" id="garbage-collection-behavior">
<h2><a class="toc-backref" href="#id13">Garbage Collection Behavior</a><a class="headerlink" href="#garbage-collection-behavior" title="Permalink to this heading"></a></h2>
<p>When using <code class="docutils literal notranslate"><span class="pre">--gc-sections</span></code> with SFrame support:</p>
<ul class="simple">
<li><p><strong>Preservation</strong>: <code class="docutils literal notranslate"><span class="pre">.sframe</span></code> sections are not subject to garbage collection and are preserved in the output</p></li>
</ul>
</div>
<div class="section" id="error-handling">
<h2><a class="toc-backref" href="#id14">Error Handling</a><a class="headerlink" href="#error-handling" title="Permalink to this heading"></a></h2>
<p>ELD provides comprehensive error detection for SFrame processing:</p>
<dl class="simple">
<dt><strong>Invalid Magic Number</strong></dt><dd><p>Reports errors for SFrame sections with incorrect magic numbers (expected: 0xdee2)</p>
</dd>
<dt><strong>Unsupported Version</strong></dt><dd><p>Detects and reports unsupported SFrame versions (ELD supports version 2)</p>
</dd>
<dt><strong>Truncated Sections</strong></dt><dd><p>Identifies and reports SFrame sections with incomplete data</p>
</dd>
<dt><strong>Address Resolution Failures</strong></dt><dd><p>Reports errors when SFrame function addresses cannot be resolved</p>
</dd>
</dl>
<p>Example error output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Error: SFrame Read Error : invalid SFrame magic number from file input.o
Error: SFrame Read Error : unsupported SFrame version from file input.o
Error: SFrame Read Error : section too small for SFrame header from file input.o
</pre></div>
</div>
</div>
<div class="section" id="performance-considerations">
<h2><a class="toc-backref" href="#id15">Performance Considerations</a><a class="headerlink" href="#performance-considerations" title="Permalink to this heading"></a></h2>
<p>SFrame support in ELD is designed for optimal performance:</p>
<dl class="simple">
<dt><strong>Link Time</strong></dt><dd><ul class="simple">
<li><p>Minimal overhead during linking</p></li>
<li><p>Efficient parsing of SFrame sections</p></li>
<li><p>Fast address resolution and fixups</p></li>
</ul>
</dd>
<dt><strong>Runtime</strong></dt><dd><ul class="simple">
<li><p>Compact sections reduce memory usage</p></li>
<li><p>Fast parsing during stack unwinding</p></li>
<li><p>Improved cache locality</p></li>
</ul>
</dd>
<dt><strong>Binary Size</strong></dt><dd><ul class="simple">
<li><p>Significantly smaller than equivalent DWARF information</p></li>
<li><p>Optional inclusion based on build requirements</p></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="best-practices">
<h2><a class="toc-backref" href="#id16">Best Practices</a><a class="headerlink" href="#best-practices" title="Permalink to this heading"></a></h2>
<ol class="arabic simple">
<li><p><strong>Consistent Usage</strong>: Use <cite>–sframe-hdr</cite> consistently across all objects in a project</p></li>
<li><p><strong>Testing</strong>: Verify SFrame functionality with debugging tools after linking</p></li>
<li><p><strong>Architecture Specific</strong>: Ensure SFrame generation tools target the correct architecture</p></li>
<li><p><strong>Integration</strong>: Combine with appropriate optimization levels for best results</p></li>
<li><p><strong>Validation</strong>: Use readelf or similar tools to verify SFrame section contents</p></li>
</ol>
</div>
<div class="section" id="troubleshooting">
<h2><a class="toc-backref" href="#id17">Troubleshooting</a><a class="headerlink" href="#troubleshooting" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt><strong>Missing SFrame Sections</strong></dt><dd><p>Ensure input objects were compiled with SFrame generation enabled</p>
</dd>
<dt><strong>Incorrect Function Addresses</strong></dt><dd><p>Verify that all input objects use consistent compilation flags</p>
</dd>
<dt><strong>Debugger Issues</strong></dt><dd><p>Check that debugging tools support SFrame format version 2</p>
</dd>
<dt><strong>Performance Problems</strong></dt><dd><p>Consider the trade-off between SFrame inclusion and binary size requirements</p>
</dd>
</dl>
<p>For additional support and troubleshooting, consult the ELD diagnostic output when using the <cite>–verbose</cite> option along with <cite>–sframe-hdr</cite>.</p>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Qualcomm Technologies, Inc. All rights reserved..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>